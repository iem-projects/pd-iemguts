image: gcc

build:
  stage: build
  before_script: 
    - apt update && apt -y install make puredata-dev
  script: 
    - declare -x CI_BUILD_REF_SHORT=$(git describe --tags)
    - export
    - make
    - make install DESTDIR=$(pwd) pkglibdir=${CI_BUILD_REF_SHORT}
  dependencies: []
  artifacts:
    name: ${CI_PROJECT_NAME}-${CI_BUILD_REF_SHORT}
    paths:
      - ./${CI_BUILD_REF_SHORT}
      - examples/
    expire_in: 1 week
