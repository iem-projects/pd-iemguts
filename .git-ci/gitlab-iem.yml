build-linux:
  image: gcc
  stage: build
  before_script:
    - apt update && apt -y install make puredata-dev
    - apt list --upgradable
  script:
    - make
    - make install DESTDIR=$(pwd) pkglibdir=/
  dependencies: []
  except:
    - tags
  artifacts:
    name: iemguts-snapshot
    paths:
      - iemguts/
    expire_in: 1 week

build-osx:
  tags:
     - osx
  stage: build
  script:
    - make
    - make install DESTDIR=$(pwd) pkglibdir=/
  dependencies: []
  except:
    - tags
  artifacts:
    name: iemguts-snapshot
    paths:
      - iemguts/
    expire_in: 1 week


release-linux:
  image: gcc
  stage: build
  before_script:
    - apt update && apt -y install make puredata-dev
    - apt list --upgradable
  script:
    - make
    - make install DESTDIR=$(pwd) pkglibdir=/
  dependencies: []
  only:
    - tags
  artifacts:
    paths:
      - iemguts/

release-osx:
  tags:
     - osx
  stage: build
  script:
    - make
    - make install DESTDIR=$(pwd) pkglibdir=/
  dependencies: []
  only:
    - tags
  artifacts:
    paths:
      - iemguts/
